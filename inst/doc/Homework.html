<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="21007" />


<title>Homework</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">21007</h4>
<h4 class="date">2021/12/19</h4>



<div id="homework0" class="section level2">
<h2>Homework0</h2>
<p>Use knitr to produce at least 3 examples (texts, figures, tables).</p>
<p>1.texts: Statistical calculation is an interdisciplinary subject of mathematical statistics, computational mathematics and computer science. This is the first job of statistical calculation.</p>
<p>2.Mathematical formula: <span class="math inline">\(e^{i\theta}=\cos\theta+i\sin\theta\)</span></p>
<p>3.figures:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>A<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">172</span>,<span class="dv">170</span>,<span class="dv">180</span>,<span class="dv">175</span>,<span class="dv">188</span>,<span class="dv">168</span>,<span class="dv">177</span>,<span class="dv">183</span>,<span class="dv">173</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">80</span>,<span class="dv">75</span>,<span class="dv">60</span>,<span class="dv">85</span>,<span class="dv">70</span>,<span class="dv">68</span>,<span class="dv">77</span>,<span class="dv">63</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(A,B,<span class="at">xlab=</span><span class="st">&quot;Height/cm&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Weight/kg&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">160</span>,<span class="dv">200</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">55</span>,<span class="dv">90</span>),<span class="at">main=</span><span class="st">&quot;Height and weight of 9 boys in a class&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>4.tables:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">15</span>),<span class="dv">5</span>,<span class="dv">3</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(a)<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="cn">NULL</span>,<span class="fu">c</span>(<span class="st">&quot;Group one&quot;</span>,<span class="st">&quot;Group two&quot;</span>,<span class="st">&quot;Group three&quot;</span>))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(a))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Group one</th>
<th align="right">Group two</th>
<th align="right">Group three</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.9485245</td>
<td align="right">0.8032813</td>
<td align="right">0.6953732</td>
</tr>
<tr class="even">
<td align="right">0.7510636</td>
<td align="right">0.3443373</td>
<td align="right">0.1689011</td>
</tr>
<tr class="odd">
<td align="right">0.4488770</td>
<td align="right">0.9545427</td>
<td align="right">0.4592789</td>
</tr>
<tr class="even">
<td align="right">0.6330027</td>
<td align="right">0.8495718</td>
<td align="right">0.1832882</td>
</tr>
<tr class="odd">
<td align="right">0.4191389</td>
<td align="right">0.8721688</td>
<td align="right">0.4848340</td>
</tr>
</tbody>
</table>
</div>
<div id="homework1" class="section level2">
<h2>Homework1</h2>
<p>Exercises 3.4, 3.11, and 3.20 (pages 94-96, Statistical Computating with R).</p>
<p><strong>3.4</strong></p>
<p>Firstly, we integrate the probability density function to obtain the probability distribution function <span class="math display">\[F(x)=1-e^{-x^2/(2σ^2)} , x≥0 , σ&gt;0\]</span> Because <span class="math inline">\(X\)</span> is a continuous random variable, <span class="math inline">\(F(X)\)</span> is a uniform distribution <span class="math inline">\(U(0,1)\)</span>.We can get <span class="math display">\[X=\sqrt{(-2σ^2\ln(1-U))}\]</span> Finally, we use the inverse transform method to solve this problem.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>; qq <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(qq<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">runif</span>(n)))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;f(x),when qq=1&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="dv">0</span>, <span class="dv">5</span>, .<span class="dv">01</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Y, (Y<span class="sc">/</span>(qq<span class="sc">^</span><span class="dv">2</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(Y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>qq<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>; qq <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(qq<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">runif</span>(n)))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;f(x),when qq=2&quot;</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="dv">0</span>, <span class="dv">10</span>, .<span class="dv">01</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Y, (Y<span class="sc">/</span>(qq<span class="sc">^</span><span class="dv">2</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(Y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>qq<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>; qq<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(qq<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">runif</span>(n)))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;f(x),when qq=3&quot;</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="dv">0</span>, <span class="dv">15</span>, .<span class="dv">01</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Y, (Y<span class="sc">/</span>(qq<span class="sc">^</span><span class="dv">2</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(Y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>qq<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>; qq<span class="ot">=</span><span class="dv">4</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(qq<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">runif</span>(n)))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;f(x),when qq=4&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">seq</span>( <span class="dv">0</span>, <span class="dv">20</span>, .<span class="dv">01</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(Y, (Y<span class="sc">/</span>(qq<span class="sc">^</span><span class="dv">2</span>))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(Y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>qq<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> As we can be seen from the figures, when <span class="math inline">\(σ\)</span> takes different values, the modes of the generated samples are all very close to the theoretical modes.</p>
<p><strong>3.11</strong></p>
<p>Firstly, we generate 1000 random numbers subject to <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(3,1)\)</span> distributions.Then, we combine the two groups of random numbers in terms of the mixing probability.</p>
<p>Let <span class="math inline">\(P_1\)</span> take <span class="math inline">\(0.75\)</span>, we can get the following figure. <img src="data:image/png;base64,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" /><!-- --> Repeat with different values for <span class="math inline">\(p_1\)</span> and observe whether the empirical distribution of the mixture appears to be bimodal.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span> ; </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>Z1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>Z2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>k1 <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(A1 <span class="sc">&lt;</span> <span class="fl">0.5</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> k1 <span class="sc">*</span> Z1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>k1) <span class="sc">*</span> Z2</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>A2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>k2 <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(A2 <span class="sc">&lt;</span> <span class="fl">0.25</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> k2 <span class="sc">*</span> Z1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>k2) <span class="sc">*</span> Z2</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>k3 <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(A3 <span class="sc">&lt;</span> <span class="fl">0.9</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> k3 <span class="sc">*</span> Z1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>k3) <span class="sc">*</span> Z2</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>A4 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>k4 <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(A4 <span class="sc">&lt;</span> <span class="fl">0.1</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>X4 <span class="ot">&lt;-</span> k4 <span class="sc">*</span> Z1 <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>k4) <span class="sc">*</span> Z2</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X1, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="fu">expression</span>(p[<span class="dv">1</span>]<span class="sc">==</span><span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAkFBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6AGY6OgA6OmY6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZgBmkJBmkLZmtv+QOgCQZgCQZjqQttuQ2/+2ZgC2Zjq2kDq2kGa22/+2/7a2/9u2///T09PbkDrbtrbb/7bb////tmb/25D/27b//7b//9v///9XLlynAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHYUlEQVR4nO2dfbuaNhiH8ezUdS+d7q1zW9nWtWMTq+f7f7sBQY9FkztIOIbwu//oVWsS4L4eYgLpk+xJOMnufQKxI0GABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEGABAESBEgQIEHAdAQd/lpmi7fb0+cia/hl5MNOR1De+HjV+SxBR8rsi/dPn344CTlsHrfOCoGYjKB88a76c7c8htB+/cpVPBhRCMofPvyRZV+/dxRpA+Y5bnbL1QucWTSCfqq7kyZGLBwDJn/4aP6hzN7+mGXfuqQGIQ5B2eL3p8MfmeOmuRDU/oi5pAYhDkHNZR42x4s3/5i1NGYuBOXZd1uQGoQ4BJmrLkw//PrjlSIXggwdqSMQnaD9+uolX3TSn1cdjzgEPd9iRfZNG0Gf32Ldn/n9+rqw4MQhqB4Emv7k3+31W+xioJhnb7ZPnzbZauRzi0PQ4qs6VMzdYhF0NtVob8Xm8+jD6TgEPXz4rRrTmGu1CTr8eZysms78U1Vl8Wb06UYkgs6c2ATdCQkCJAiQICAKQTEjQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAgQYAEARIESBAQg6Csy71P6JwYTib753NiOKcTMZzMhaCYIipKQTFF1AQFvWyATVHQiwZYCoJGjagUBI0aURJEJxe0tduQIECCAAkCJAiQIECCAAkCZiBo2DB/BoKGNSdBVEmCoJIEQSUJgkp0xR0kyP1ZgiSoW2kSgvbrEAnlEhZkMhOuwjXXo9JEBD0FcJS6IKNoQOa9xAWVTX7mIan3UhZUp5UzZsrbQyhhQfu1R97Yw8aMZa0GUxb0vfHjCp/i2IOXtq58BoIKu6DDZnX8a2HpppIVlD9PBVfWsvv1KcO+Lc6SFfQcQQ7mHEF+FMdUs3Psg7xoM8zaU8ymKmi/Xh2vfcg4Ol1B921OgqjSNARVt1k9VR2WwTplQfnjts4Yn9sfm526KXtPlbCgehRYVj/jrqkGb9KQuKA6bbFjqlEbgseyCQuq7q16KwbYdKm8vp/XyIsX4hBU9TCLdxgi3s31qTQNQfdrToKo0jQE4dPCc2xdecqCgmwjlLCgeiAdsLlelSYiKMSGnAkL8vqBn/NbDdsY8Jx5v9XgB2Z6Jg3M+62GB3OPoOome9zmK0fhUG81+q7KjENQuXhX1LP5laN0oLcafa84CkH1/VPfOM7nQf7NuUtNUVDdA9eCBqx9eUpa0DGC8kFP7RMW1PZBBQ8X/ZpzlpqkINMDD9x9O2lBL9ecBFGpcQUFzXXSmYsN3Rk4CkGdj2GuKDedczFwrX2ygspj57xbTv9XbARBZ0/LHO/mvZvDUpMTdDYDS2CqMYogfNLTpzksJUFQanaCeg465ieo0xyWmqAgXDvWpzksNTlBwZCgIM1JEJWSICglQVBKgqCUBEEpCYJSEgSlJAhKSRCUSlZQoCV4yQoKtQQvVUHBFlClKijYErxUBSmCiGBL8FIVNJEleHcUFKg5CaJSyQq6caDYXZDysoKGLYd5kYFi4CseWLzPFb/Qz/xcBN08UJyLIEUQYR0odnrAi34xKkYUxAPF9Ag8DkoPCQJuFDRsod6UGCWC7tsJEzEIGvb9sK+HVh9WPEyj6QryTIAyW0E8WfVrNFVBHlMNv0ZTFeS9FnaughRBBL/V8Gs0WUG+k9X5CpohEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBYwlypUJrnmyvLF+WzixYzqoeh94ts5777Y4kqHQ8ETlsKgOF5TzrNDSl1ZCzqsehy+or2PehyziCmqSeti9NBp7r72bNQ0trBhpXVY9Dm9b7vRUeR1Dx+CstALkeJh4GbFU9Dr37sn8Ku1EEVSeC6Rivp9A3lwDpMVzZ952HLh/+Xvfdq3kMQXUkkyDLU20THM4QcT4Qdx+6qN949txbZQxBHgk9S0cfDYJsVT0OXSw84rPDCIKa28QtyBoEfIs5X6jAoU3f1i9NW1hBzXbsRbvM5MpptNu123PtYSftTtPnOHSNEd+vq77HQNGRLxZ+5l1VPQ5tXg3f/RZrcAjaLVf2eu6BorOqx6HrLurs/bAPdxDU3gcWC4VrquGuyoeuJzIR/MwnhQQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgTEK2i3NO/Y2wUdu9f3ScgTr6B2qVS7oGO/vlPGoogFNYs12xWF5cBtvW4nZkH1km+z2KwKpmEbw91OzIKq2+vn03pCCbrG2YpECbrCYfPc80jQFfLH/07/80SCLimrEdBpWbQEXbBb1tGTtys2JajLYdMo2a/NgFqCOlQdtPmFb/9vhgRFigQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIEPA/lfO1fEHKW8MAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X2, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="fu">expression</span>(p[<span class="dv">1</span>]<span class="sc">==</span><span class="fl">0.25</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X3, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="fu">expression</span>(p[<span class="dv">1</span>]<span class="sc">==</span><span class="fl">0.9</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X4, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="fu">expression</span>(p[<span class="dv">1</span>]<span class="sc">==</span><span class="fl">0.1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> By observing the figures generated by different <span class="math inline">\(p_1\)</span>, we can find that the closer <span class="math inline">\(p_1\)</span> is to <span class="math inline">\(0.5\)</span>, the more obvious the bimodal mixtures are.</p>
<p><strong>3.20</strong></p>
<p>Firstly, we need to take a sample <span class="math inline">\(N(t)\)</span> from the Poisson(<span class="math inline">\(\lambda\)</span>) process. Then, we take <span class="math inline">\(N(t)\)</span> samples from the gamma distribution <span class="math inline">\(Gamma(r,\beta)\)</span> and add the values of these samples together.Repeat the above process <span class="math inline">\(n\)</span> times.</p>
<p>According to the hint, we can know <span class="math display">\[E(X(t))=\lambda tE(Y_1)=\lambda t \frac{r}{\beta}\]</span> <span class="math display">\[Var(X(t))=\lambda tE(Y_1^2)=\lambda t \frac{r(r+1)}{\beta^2}\]</span> In the end, estimate the mean and the variance of <span class="math inline">\(X(10)\)</span> for several choices of the parameters and compare with the theoretical values.</p>
<p>When <span class="math inline">\(\lambda=2,r=3,\beta=4\)</span>, <span class="math display">\[E(X(t))=15,Var(X(t))=15\]</span> The mean and variance of the sample are as follows:</p>
<pre><code>## [1] 15.02124</code></pre>
<pre><code>## [1] 16.03127</code></pre>
<p>When <span class="math inline">\(\lambda=5,r=6,\beta=10\)</span> <span class="math display">\[E(X(t))=30,Var(X(t))=21\]</span> The mean and variance of the sample are as follows:</p>
<pre><code>## [1] 30.06035</code></pre>
<pre><code>## [1] 20.52422</code></pre>
<p>As we can see, the estimates of the mean and variance are very close to the theoretical values.</p>
</div>
<div id="homework2" class="section level2">
<h2>Homework2</h2>
<p>Exercises 5.4, 5.9, 5.13, and 5.14 (pages 149-151, Statistical Computating with R).</p>
<p><strong>5.4</strong></p>
<p>The Cumulative distribution function (CDF) of Beta(3,3) is <span class="math display">\[F(x)=\int_{0}^{x}\frac{1}{B(3,3)}x^2(1-x)^2\,dx ,  0\le x\le 1\]</span> Where, <span class="math display">\[B(3,3)=\int_{0}^{1}x^2(1-x)^2\,dx=\frac{1}{30}\]</span> Compare the Monte Carlo estimates with the values returned by the pbeta function for x=0.1,0.2, … ,0.9.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>;</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span>x);</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">mean</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>a)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>x</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">9</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">9</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  c[i]<span class="ot">=</span><span class="fu">f</span>(i<span class="sc">/</span><span class="dv">10</span>)<span class="sc">*</span><span class="dv">30</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  d[i]<span class="ot">=</span><span class="fu">pbeta</span>(i<span class="sc">/</span><span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span><span class="fu">c</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">rbind</span>(e,c,d)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(p) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;estimates&quot;</span>,<span class="st">&quot;pbeta&quot;</span>)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(p))</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="10%" />
<col width="9%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left">x</td>
<td align="right">0.100000</td>
<td align="right">0.2000000</td>
<td align="right">0.3000000</td>
<td align="right">0.4000000</td>
<td align="right">0.5000000</td>
<td align="right">0.6000000</td>
<td align="right">0.7000000</td>
<td align="right">0.8000000</td>
<td align="right">0.9000000</td>
</tr>
<tr class="even">
<td align="left">estimates</td>
<td align="right">0.008883</td>
<td align="right">0.0580836</td>
<td align="right">0.1605137</td>
<td align="right">0.3202252</td>
<td align="right">0.4817869</td>
<td align="right">0.6645643</td>
<td align="right">0.8240021</td>
<td align="right">0.9474463</td>
<td align="right">0.9970208</td>
</tr>
<tr class="odd">
<td align="left">pbeta</td>
<td align="right">0.008560</td>
<td align="right">0.0579200</td>
<td align="right">0.1630800</td>
<td align="right">0.3174400</td>
<td align="right">0.5000000</td>
<td align="right">0.6825600</td>
<td align="right">0.8369200</td>
<td align="right">0.9420800</td>
<td align="right">0.9914400</td>
</tr>
</tbody>
</table>
<p>As we can see, the estimates are very close to the values returned by the pbeta function.</p>
<p><strong>5.9</strong></p>
<p>Firstly, we integrate the probability density function to obtain the probability distribution function <span class="math display">\[F(x)=1-e^{-x^2/(2σ^2)} , x≥0 , σ&gt;0\]</span> Because <span class="math inline">\(X\)</span> is a continuous random variable, <span class="math inline">\(F(X)\)</span> is a uniform distribution <span class="math inline">\(U(0,1)\)</span>.We can get <span class="math display">\[X=\sqrt{(-2σ^2\ln(1-U))}\]</span></p>
<p>The antithetic variable is <span class="math display">\[X&#39;=\sqrt{(-2σ^2\ln(U))}\]</span></p>
<p>We take different values for <span class="math inline">\(\sigma\)</span> to calculate the percent reduction in variance.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>rf <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">1000</span>;</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>a))</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  X_anti <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(a))</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>a))</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(sigma<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>b))</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> <span class="fu">var</span>((X<span class="sc">+</span>X_anti)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="fu">var</span>((X1<span class="sc">+</span>X2)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((f<span class="sc">-</span>e)<span class="sc">/</span>f)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">10</span>)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  h[i] <span class="ot">&lt;-</span> <span class="fu">rf</span>(i)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">rbind</span>(g,h)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">round</span>(k,<span class="dv">3</span>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(k) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;σ&quot;</span>,<span class="st">&quot;reduction in var&quot;</span>)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(k))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">σ</td>
<td align="right">1.000</td>
<td align="right">2.000</td>
<td align="right">3.000</td>
<td align="right">4.000</td>
<td align="right">5.000</td>
<td align="right">6.000</td>
<td align="right">7.000</td>
<td align="right">8.000</td>
<td align="right">9.000</td>
<td align="right">10.00</td>
</tr>
<tr class="even">
<td align="left">reduction in var</td>
<td align="right">0.941</td>
<td align="right">0.949</td>
<td align="right">0.934</td>
<td align="right">0.956</td>
<td align="right">0.957</td>
<td align="right">0.944</td>
<td align="right">0.953</td>
<td align="right">0.941</td>
<td align="right">0.946</td>
<td align="right">0.96</td>
</tr>
</tbody>
</table>
<p>As we can see, no matter what the value of <span class="math inline">\(sigma\)</span> is, the percent reduction in variance of <span class="math inline">\(\frac{X+X&#39;}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span> are all very close to <span class="math inline">\(94.7\%\)</span>.</p>
<p><strong>5.13</strong></p>
<p>We can find two importance functions <span class="math display">\[f_1=e^{-x},x&gt;1\]</span> <span class="math display">\[f_2=\frac{1}{\sqrt{2\pi}}e^{-\frac{(x-1.65)^2}{2}},x&gt;1\]</span></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> (x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="dv">1</span>)    <span class="co">#using f1</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="fl">1.65</span>,<span class="dv">1</span>)   <span class="co">#using f2</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>(x<span class="fl">-1.65</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">rbind</span>(theta.hat,se)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(c) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;f&#39;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(c)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">f1</th>
<th align="right">f2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">theta.hat</td>
<td align="right">0.4441449</td>
<td align="right">0.4021722</td>
</tr>
<tr class="even">
<td align="left">se</td>
<td align="right">0.5990480</td>
<td align="right">0.2949112</td>
</tr>
</tbody>
</table>
<p>As we can see, <span class="math display">\[f_2=\frac{1}{\sqrt{2\pi}}e^{-\frac{(x-1.65)^2}{2}},x&gt;1\]</span> produce the smaller variance in estimating <span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}\,dx\]</span></p>
<p><strong>5.14</strong></p>
<p>From 5.13, we can know that <span class="math display">\[f_2=\frac{1}{\sqrt{2\pi}}e^{-\frac{(x-1.65)^2}{2}},x&gt;1\]</span> is an importance function with smaller variance.So we use <span class="math inline">\(f_2\)</span> to estimate <span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}\,dx\]</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> (x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="fl">1.65</span>,<span class="dv">1</span>)   <span class="co">#using f2</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>(x<span class="fl">-1.65</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(fg)</span></code></pre></div>
<pre><code>## [1] 0.4215298</code></pre>
<p>As we can see, the Monte Carlo estimate of <span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}\,dx\]</span> by importance sampling is close to <span class="math inline">\(0.4\)</span>.</p>
</div>
<div id="homework3" class="section level2">
<h2>Homework3</h2>
<p>Exercises 6.5 and 6.A (page 180-181, Statistical Computating with R).</p>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.</p>
<p>(1)What is the corresponding hypothesis test problem?</p>
<p>(2)What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?</p>
<p>(3)Please provide the least necessary information for hypothesis testing.</p>
<p><strong>6.5</strong></p>
<p>As we all know, <span class="math display">\[\frac{\bar{x}-u}{S}\sqrt{n}\sim t(n-1)\]</span> So the <span class="math inline">\(1-\alpha\)</span> confidence interval of the mean is <span class="math display">\[(\bar{x}-\frac{t_{\frac{\alpha}{2}}(n-1)S}{\sqrt{n}},\bar{x}+\frac{t_{\frac{\alpha}{2}}(n-1)S}{\sqrt{n}})\]</span> The coverage probability can be approximated by <span class="math display">\[\frac{1}{m} \sum\limits_{j=1}^mI(\hat{\theta}_1^{(j)}&lt;\theta&lt;\hat{\theta}_2^{(j)})\]</span> Where <span class="math inline">\((\hat{\theta}_1^{(j)},\hat{\theta}_2^{(j)})\)</span> is the CI of <span class="math inline">\(\theta\)</span> in the <span class="math inline">\(j\)</span>th MC experiment.</p>
<p>We take random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n=20\)</span>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span>;alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">1000</span>) ;b <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">2</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  a[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x))<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  b[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x))<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>( a<span class="sc">&gt;</span><span class="dv">2</span> <span class="sc">&amp;</span> b<span class="sc">&lt;</span><span class="dv">2</span> )</span></code></pre></div>
<pre><code>## [1] 0.932</code></pre>
<p>The estimate of the CP of the t-interval is around <span class="math inline">\(0.93\)</span>, which is smaller than <span class="math inline">\(0.95\)</span>.</p>
<p>Compared with Example 6.4, the t-interval is more robust to departures from normality than the interval for variance.</p>
<p><strong>6.A</strong></p>
<p>It is calculated that the mean of <span class="math inline">\(\chi^2(1)\)</span>, <span class="math inline">\(Uniform(0,2)\)</span> and <span class="math inline">\(Exponential(1)\)</span> are the same: <span class="math display">\[u_0=1\]</span></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10000</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span>;alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>;u<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>) ;b <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>) ;c <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  ttest1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">mu=</span>u)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  a[i] <span class="ot">&lt;-</span> ttest1<span class="sc">$</span>p.value</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  ttest2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y,<span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">mu=</span>u)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  b[i] <span class="ot">&lt;-</span> ttest2<span class="sc">$</span>p.value</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  ttest3 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(z,<span class="at">mu=</span>u)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  c[i] <span class="ot">&lt;-</span> ttest3<span class="sc">$</span>p.value</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> e <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>d[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(a<span class="sc">&lt;</span>alpha)</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>d[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(b<span class="sc">&lt;</span>alpha)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>d[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(c<span class="sc">&lt;</span>alpha)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>e[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(d[<span class="dv">1</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>d[<span class="dv">1</span>])<span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>e[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(d[<span class="dv">2</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>d[<span class="dv">2</span>])<span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>e[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(d[<span class="dv">3</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>d[<span class="dv">3</span>])<span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span> <span class="fu">rbind</span>(d,e)</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(p) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;alpha.hat&quot;</span>,<span class="st">&quot;se.hat&quot;</span>)</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(p) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;卡方(1)&quot;</span>,<span class="st">&quot;Uniform(0,2)&quot;</span>,<span class="st">&quot;Exponential(1)&quot;</span>)</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(p)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">卡方(1)</th>
<th align="right">Uniform(0,2)</th>
<th align="right">Exponential(1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha.hat</td>
<td align="right">0.0500000</td>
<td align="right">0.0300000</td>
<td align="right">0.0700000</td>
</tr>
<tr class="even">
<td align="left">se.hat</td>
<td align="right">0.0217945</td>
<td align="right">0.0170587</td>
<td align="right">0.0255147</td>
</tr>
</tbody>
</table>
<p>As we can see, the t-test is robust to mild departures from normality.</p>
<p><strong>3</strong></p>
<p>3.1 <span class="math display">\[H_0: power_1=power_2\quad (The\ powers\ are\ the\ same\ at\ 0.05\ level.)\]</span> <span class="math display">\[H_1: power_1\neq power_2\quad (The\ powers\ are\ different\ at\ 0.05\ level.)\]</span> Where <span class="math inline">\(power_1\)</span> and <span class="math inline">\(power_2\)</span> stand for the powers for two methods under a particular simulation setting with 10,000 experiments.</p>
<p>3.2</p>
<p>I think paired-t test is the best choice.</p>
<p>As for two-sample t-test, it requires two sets of samples to be independent, but this subject does not meet this condition. As for Z-test and McNemar test, they are better for large samples.</p>
<p>3.3</p>
<p>We should know the following four messages:</p>
<p><span class="math inline">\(n\)</span>:The number of repeated tests. Then we can get n <span class="math inline">\(power_1\)</span> and n <span class="math inline">\(power_2\)</span>.</p>
<p><span class="math inline">\(\bar{power_1}\)</span>:Then mean of <span class="math inline">\(power_1\)</span>.</p>
<p><span class="math inline">\(\bar{power_2}\)</span>:Then mean of <span class="math inline">\(power_2\)</span>.</p>
<p><span class="math inline">\(S_{power_1-power_2}\)</span>:The standard deviation of <span class="math inline">\(power_1-power_2\)</span>.</p>
<p>Last, we can use the four messages to do paired-t test.</p>
</div>
<div id="homework4" class="section level2">
<h2>Homework4</h2>
<p>Exercises 6.C (pages 182, Statistical Computating with R).</p>
<p><strong>6.C</strong></p>
<p>Firstly, Repeat <strong>Examples 6.8</strong> for Mardia’s multivariate skewness test.</p>
<p>We take <span class="math inline">\(d=2\)</span>,<span class="math inline">\(\alpha=0.05\)</span>, <span class="math display">\[X \sim N(0,0 ; 1,2 ; 0)\]</span></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">29999</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)        </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">rbind</span>(v1,v2)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>cr <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.95</span> , d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>T1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){          </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">nrow</span>(x)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n,d)      </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d){</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>       x1[,i]<span class="ot">&lt;-</span>x[,i]<span class="sc">-</span><span class="fu">mean</span>(x[,i])</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  covbar <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,d,d)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    covbar <span class="ot">&lt;-</span> covbar <span class="sc">+</span> <span class="fu">outer</span>(x1[i,],x1[i,])</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  covbar <span class="ot">&lt;-</span> covbar<span class="sc">/</span>n </span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>  nicovbar <span class="ot">&lt;-</span> <span class="fu">solve</span>(covbar)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>  b_id <span class="ot">&lt;-</span> <span class="dv">0</span>                </span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>      b_id <span class="ot">&lt;-</span> b_id <span class="sc">+</span> (x1[i,]<span class="sc">%*%</span>nicovbar<span class="sc">%*%</span>x1[j,])<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  b_id <span class="ot">&lt;-</span> b_id <span class="sc">/</span> (n<span class="sc">*</span>n)</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(n<span class="sc">*</span>b_id<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>Tl <span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>    n<span class="ot">&lt;-</span><span class="fu">nrow</span>(x)</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>    x1<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,n,d)</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d){</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>       x1[,i]<span class="ot">&lt;-</span>x[,i]<span class="sc">-</span><span class="fu">mean</span>(x[,i])</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>    covbar<span class="ot">&lt;-</span><span class="fu">t</span>(x1)<span class="sc">%*%</span>x1<span class="sc">/</span>n</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span>x1<span class="sc">%*%</span><span class="fu">solve</span>(covbar)<span class="sc">%*%</span><span class="fu">t</span>(x1)</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>    z<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">colSums</span>(y<span class="sc">^</span>{<span class="dv">3</span>}))<span class="sc">/</span>(n<span class="sc">*</span>n)  </span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(n<span class="sc">*</span>z<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">6</span>)</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>){</span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">&lt;-</span> <span class="fu">numeric</span>(b)</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>b){</span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n[i],u,v)</span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>    s[j] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">abs</span>(<span class="fu">Tl</span>(x)) <span class="sc">&gt;=</span> cr)</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>  a[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(s)</span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span><span class="fu">rbind</span>(n,a)</span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(q) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;n&quot;</span>,<span class="st">&quot;estimate&quot;</span>)</span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(q))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">n</td>
<td align="right">10</td>
<td align="right">20</td>
<td align="right">30</td>
<td align="right">50.0</td>
<td align="right">100.0</td>
<td align="right">500</td>
</tr>
<tr class="even">
<td align="left">estimate</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.1</td>
<td align="right">0.1</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>As we can see, When n is large enough, the estimates is close to <span class="math inline">\(\alpha=0.05\)</span>.</p>
<p>Secondly, Repeat <strong>Examples 6.10</strong> for Mardia’s multivariate skewness test.</p>
<p>We take <span class="math inline">\(d=2\)</span>,<span class="math inline">\(\alpha=0.1\)</span>, <span class="math display">\[(1-\epsilon)N(0,0 ; 1,1 ; 0)+\epsilon N(0,0;64,64;0), 0 \le \epsilon \le 1\]</span></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">19999</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>afa <span class="ot">=</span> <span class="fl">0.1</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">199</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>ep <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.15</span>,<span class="fl">0.1</span>),<span class="fu">seq</span>(<span class="fl">0.15</span>,<span class="dv">1</span>,<span class="fl">0.5</span>))</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">length</span>(ep)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>po <span class="ot">&lt;-</span> <span class="fu">numeric</span>(L)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>cr <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.9</span>,d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)  </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,a,d)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>L){       </span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> ep[j]</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">numeric</span>(b)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>b){</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    σ <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">64</span>), <span class="at">replace =</span> T , <span class="at">size =</span> a , <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>q , q) )  </span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>       <span class="cf">for</span>(g <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>a){                                              </span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>         r <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(σ[g],<span class="dv">0</span>,<span class="dv">0</span>,σ[g]),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>         x[g,] <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">1</span>, u, r)</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>       }</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    s[i] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">abs</span>(<span class="fu">Tl</span>(x))<span class="sc">&gt;=</span>cr)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  po[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(s)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ep,po,<span class="at">type =</span> <span class="st">&quot;b&quot;</span> , <span class="at">xlab =</span> <span class="fu">bquote</span>(ep) , <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))    </span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.1</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>stanerror <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(po<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>po)<span class="sc">/</span>b)</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(ep,po<span class="sc">+</span>stanerror,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(ep,po<span class="sc">-</span>stanerror,<span class="at">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> As we can see, When <span class="math inline">\(\epsilon=0\)</span> or <span class="math inline">\(\epsilon=1\)</span>, the curve intersects <span class="math inline">\(\alpha=0.1\)</span>. When <span class="math inline">\(\epsilon\)</span> is around 0.15, the power reaches the maximum.</p>
</div>
<div id="homework5" class="section level2">
<h2>Homework5</h2>
<p>Exercises 7.7, 7.8, 7.9, and 7.B (pages 213, Statistical Computating with R).</p>
<p><strong>7.7</strong></p>
<p>Firstly, we calculate the sample estimate of <span class="math inline">\(\theta\)</span>.</p>
<p>Secondly, we use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scor,<span class="at">package=</span><span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(scor)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)          </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){                </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  x[i] <span class="ot">=</span> <span class="fu">mean</span>(scor[,i])</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,m,n)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  y[,i]<span class="ot">=</span>scor[,i]<span class="sc">-</span>x[i]</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">t</span>(y)<span class="sc">%*%</span>y<span class="sc">/</span>(m<span class="dv">-1</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">eigen</span>(z)<span class="sc">$</span>values     </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> a[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(a) </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>t</span></code></pre></div>
<pre><code>## [1] 0.619115</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10000</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i){       </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> x[i,]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(y))<span class="sc">$</span>values </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(a)) </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>bhat <span class="ot">=</span> <span class="fu">boot</span>(<span class="at">data =</span> scor, <span class="at">statistic =</span> f, <span class="at">R =</span> <span class="dv">2000</span>)  </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>bis_bo <span class="ot">=</span> <span class="fu">mean</span>(bhat<span class="sc">$</span>t)<span class="sc">-</span>t        </span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>se_bo <span class="ot">=</span> <span class="fu">sd</span>(bhat<span class="sc">$</span>t)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>bis_bo</span></code></pre></div>
<pre><code>## [1] 0.002651001</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>se_bo</span></code></pre></div>
<pre><code>## [1] 0.04673587</code></pre>
<p>So, we can get the sample estimate <span class="math inline">\(\hat{\theta}\)</span> is close to <span class="math inline">\(0.62\)</span>. By using bootstrap <span class="math inline">\(B=2000\)</span>, we can get the bis is close to <span class="math inline">\(0.0027\)</span>, the standard error is close to <span class="math inline">\(0.0467\)</span>.</p>
<p><strong>7.8</strong></p>
<p>Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){         </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor[<span class="sc">-</span>i,]))<span class="sc">$</span>values</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> y[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(y)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>bis_ja <span class="ot">=</span> (m<span class="dv">-1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(x)<span class="sc">-</span>t)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>se_ja <span class="ot">=</span> (m<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(x)<span class="sc">/</span>m)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>bis_ja</span></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>se_ja</span></code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
<p>As we can see, by using Jackknife, we can get the bis is close to <span class="math inline">\(0.0011\)</span>, the standard error is close to <span class="math inline">\(0.0496\)</span>.</p>
<p><strong>7.9</strong></p>
<p>Compute <span class="math inline">\(95\%\)</span> percentile and BCa confidence intervals for <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(bhat, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = bhat, type = c(&quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level     Percentile            BCa          
## 95%   ( 0.5253,  0.7084 )   ( 0.5209,  0.7040 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>As we can see, when I take <span class="math inline">\(B=2000\)</span>, the <span class="math inline">\(95\%\)</span> percentile confidence intervals <span class="math inline">\((0.5253,0.7084)\)</span> and the BCa confidence intervals <span class="math inline">\((0.5209,0.7040)\)</span> for <span class="math inline">\(\hat{\theta}\)</span> are very close.</p>
<p><strong>7.B</strong></p>
<p>The skewness of the random variable <span class="math inline">\(X\)</span> is <span class="math display">\[\sqrt{\beta_1}=\frac{E[(X-\mu_X)]^3}{\sigma_X^3}\]</span> Where <span class="math inline">\(\mu_X=E[X]\)</span>, <span class="math inline">\(\sigma_X^2 = Var(X)\)</span>. And skewness statistics of samples is <span class="math display">\[\sqrt{b_1}=\frac{\frac{1}{n}\sum_{i=1}^n(x_i-\bar X)^3}{[\frac{1}{n}\sum_{i=1}^n(x_i-\bar X)^2]^{3/2}}\]</span> Firstly, we consider the normal distribution <span class="math inline">\(N(0,1)\)</span>(skewness 0).</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">30000</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i){   </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">=</span>x[i]</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  ybar <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>((y<span class="sc">-</span>ybar)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> <span class="fu">mean</span>((y<span class="sc">-</span>ybar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p<span class="sc">/</span>(q<span class="sc">^</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">=</span> b1 <span class="ot">=</span> c1 <span class="ot">=</span> <span class="dv">0</span>      </span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">=</span> b2 <span class="ot">=</span> c2 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>a3 <span class="ot">=</span> b3 <span class="ot">=</span> c3 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){      </span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="dv">0</span>               </span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  bhat <span class="ot">=</span> <span class="fu">boot</span>(<span class="at">data =</span> x, <span class="at">statistic =</span> f, <span class="at">R =</span> <span class="dv">500</span>)  </span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">=</span> <span class="fu">boot.ci</span>(bhat, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&lt;</span> ci<span class="sc">$</span>norm[<span class="dv">2</span>]){</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>    a1 <span class="ot">=</span> a1 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>    c1 <span class="ot">=</span> c1 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&gt;</span> ci<span class="sc">$</span>norm[<span class="dv">3</span>]){</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>    b1 <span class="ot">=</span> b1 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>    c1 <span class="ot">=</span> c1 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&lt;</span> ci<span class="sc">$</span>basic[<span class="dv">4</span>]){</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>    a2 <span class="ot">=</span> a2 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>    c2 <span class="ot">=</span> c2 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&gt;</span> ci<span class="sc">$</span>basic[<span class="dv">5</span>]){</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>    b2 <span class="ot">=</span> b2 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>    c2 <span class="ot">=</span> c2 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&lt;</span> ci<span class="sc">$</span>perc[<span class="dv">4</span>]){</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>    a3 <span class="ot">=</span> a3 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>    c3 <span class="ot">=</span> c3 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&gt;</span> ci<span class="sc">$</span>perc[<span class="dv">5</span>]){</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>    b3 <span class="ot">=</span> b3 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>    c3 <span class="ot">=</span> c3 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>c1<span class="sc">/</span><span class="dv">10</span>,a1<span class="sc">/</span><span class="dv">10</span>,b1<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>c2<span class="sc">/</span><span class="dv">10</span>,a2<span class="sc">/</span><span class="dv">10</span>,b2<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>c3<span class="sc">/</span><span class="dv">10</span>,a3<span class="sc">/</span><span class="dv">10</span>,b3<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(A,B,C)</span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Z) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>)</span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Z) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;covskewneserage rate&quot;</span>,<span class="st">&quot;left miss&quot;</span>,<span class="st">&quot;right miss&quot;</span>)</span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Z))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">covskewneserage rate</th>
<th align="right">left miss</th>
<th align="right">right miss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">norm</td>
<td align="right">0.9</td>
<td align="right">0.1</td>
<td align="right">0.0</td>
</tr>
<tr class="even">
<td align="left">basic</td>
<td align="right">0.8</td>
<td align="right">0.1</td>
<td align="right">0.1</td>
</tr>
<tr class="odd">
<td align="left">perc</td>
<td align="right">1.0</td>
<td align="right">0.0</td>
<td align="right">0.0</td>
</tr>
</tbody>
</table>
<p>As we can see, the coverage rates of the three kinds of confidence intervals are close to <span class="math inline">\(95\%\)</span>. The proportion of times that the confidence intervals miss on the left, and the proportion of times that the confidence intervals miss on the right are very close, both around <span class="math inline">\(0.025\)</span>.</p>
<p>Secondly, we consider <span class="math inline">\(\chi ^2(5)\)</span>(positive skewness).</p>
<p>As we all know, the probability density function of <span class="math inline">\(X \sim \chi ^2(5)\)</span> is <span class="math display">\[f(x)=\frac{1}{3\sqrt{2\pi}}x^{\frac{3}{2}}e^{-\frac{x}{2}}\]</span> And <span class="math inline">\(E(X)=5\)</span>, <span class="math inline">\(Var(X)=10\)</span>, <span class="math inline">\(E(X^2)=Var(X)+[E(X)]^2=35\)</span>. <span class="math display">\[E(X^3)=\int_{0}^{\infty}f(x)*x^3 \, dx \\
      =\int_{0}^{\infty}\frac{1}{3\sqrt{2\pi}}x^{\frac{9}{2}}e^{-\frac{x}{2}} \, dx \\
       =\frac{1}{3\sqrt{2\pi}}*2^{\frac{11}{2}}\int_{0}^{\infty}(\frac{x}{2})^{\frac{11}{2}-1}e^{-\frac{x}{2}} \, d(\frac{x}{2}) \\
       =\frac{1}{3\sqrt{2\pi}}*2^{\frac{11}{2}}*\Gamma(\frac{11}{2})  \\
       =315\]</span> So, the skewness of <span class="math inline">\(\chi ^2(5)\)</span> is <span class="math display">\[\sqrt{\beta_{\chi ^2(5)}}=\frac{E[(X-\mu_X)]^3}{\sigma_X^3} \\
    =\frac{E(X^3)-3E(X)E(X^2)+2[E(X)]^3}{[Var(X)]^\frac{3}{2}} \\
    =\frac{315-3*5*35+2*5^3}{10\sqrt{10}} \\
    =\sqrt{\frac{8}{5}}\]</span></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">30000</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i){       </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">=</span>x[i]</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  ybar <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>((y<span class="sc">-</span>ybar)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> <span class="fu">mean</span>((y<span class="sc">-</span>ybar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p<span class="sc">/</span>(q<span class="sc">^</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">=</span> b1 <span class="ot">=</span> c1 <span class="ot">=</span> <span class="dv">0</span>      </span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">=</span> b2 <span class="ot">=</span> c2 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>a3 <span class="ot">=</span> b3 <span class="ot">=</span> c3 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){  </span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">10</span>,<span class="dv">5</span>)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span>  <span class="fu">sqrt</span>(<span class="fl">1.6</span>)               </span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  bhat <span class="ot">=</span> <span class="fu">boot</span>(<span class="at">data =</span> x, <span class="at">statistic =</span> f, <span class="at">R =</span> <span class="dv">500</span>)  </span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">=</span> <span class="fu">boot.ci</span>(bhat, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&lt;</span> ci<span class="sc">$</span>norm[<span class="dv">2</span>]){</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>    a1 <span class="ot">=</span> a1 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>    c1 <span class="ot">=</span> c1 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&gt;</span> ci<span class="sc">$</span>norm[<span class="dv">3</span>]){</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    b1 <span class="ot">=</span> b1 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>    c1 <span class="ot">=</span> c1 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&lt;</span> ci<span class="sc">$</span>basic[<span class="dv">4</span>]){</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>    a2 <span class="ot">=</span> a2 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>    c2 <span class="ot">=</span> c2 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&gt;</span> ci<span class="sc">$</span>basic[<span class="dv">5</span>]){</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>    b2 <span class="ot">=</span> b2 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>    c2 <span class="ot">=</span> c2 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&lt;</span> ci<span class="sc">$</span>perc[<span class="dv">4</span>]){</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>    a3 <span class="ot">=</span> a3 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>    c3 <span class="ot">=</span> c3 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( y <span class="sc">&gt;</span> ci<span class="sc">$</span>perc[<span class="dv">5</span>]){</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>    b3 <span class="ot">=</span> b3 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>    c3 <span class="ot">=</span> c3 <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>c1<span class="sc">/</span><span class="dv">10</span>,a1<span class="sc">/</span><span class="dv">10</span>,b1<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>c2<span class="sc">/</span><span class="dv">10</span>,a2<span class="sc">/</span><span class="dv">10</span>,b2<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>c3<span class="sc">/</span><span class="dv">10</span>,a3<span class="sc">/</span><span class="dv">10</span>,b3<span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(A,B,C)</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Z) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>)</span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Z) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;coverage rate&quot;</span>,<span class="st">&quot;left miss&quot;</span>,<span class="st">&quot;right miss&quot;</span>)</span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Z))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">coverage rate</th>
<th align="right">left miss</th>
<th align="right">right miss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">norm</td>
<td align="right">0.9</td>
<td align="right">0</td>
<td align="right">0.1</td>
</tr>
<tr class="even">
<td align="left">basic</td>
<td align="right">0.9</td>
<td align="right">0</td>
<td align="right">0.1</td>
</tr>
<tr class="odd">
<td align="left">perc</td>
<td align="right">0.8</td>
<td align="right">0</td>
<td align="right">0.2</td>
</tr>
</tbody>
</table>
<p>As we can see, the coverage rates of the three kinds of confidence intervals are close to <span class="math inline">\(88\%\)</span>. The proportion of times that the confidence intervals miss on the left are so low, lower than <span class="math inline">\(0.01\)</span>. And the proportion of times that the confidence intervals miss on the right are around <span class="math inline">\(0.115\)</span>.</p>
</div>
<div id="homework6" class="section level2">
<h2>Homework6</h2>
<p>Exercise 8.2 (page 242, Statistical Computating with R).</p>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<p>(1)Unequal variances and equal expectations</p>
<p>(2)Unequal variances and unequal expectations</p>
<p>(3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p>
<p>(4)Unbalanced samples (say, 1 case versus 10 controls).Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
<p><strong>8.2</strong></p>
<p>We take <span class="math inline">\(\alpha = 0.05\)</span>.</p>
<p>Firstly, we choose <span class="math display">\[X_1 \sim N(0,1) \\ Y_1=X_1+1\]</span> Obviously, <span class="math inline">\(X_1\)</span> and <span class="math inline">\(Y_1\)</span> are not independent of each other. Then, test it.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>xyCor <span class="ot">&lt;-</span> <span class="cf">function</span>(Z,ix){</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> Z[,<span class="dv">1</span>]</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> Z[ix,<span class="dv">2</span>]</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cor</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">15</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>Y1 <span class="ot">&lt;-</span> X1<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>Z1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X1,Y1)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> Z1, <span class="at">statistic =</span>xyCor, <span class="at">R=</span><span class="dv">999</span>, <span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>)</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">c</span>(a1<span class="sc">$</span>t0,a1<span class="sc">$</span>t)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(b1 <span class="sc">&gt;=</span> a1<span class="sc">$</span>t0)</span></code></pre></div>
<pre><code>## [1] 0.001</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X1,Y1)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>c1<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 3.876914e-103</code></pre>
<p>The achieved significance level of the permutation test is close to <span class="math inline">\(0.001\)</span>. The p-value reported by cor.test on the same samples is <span class="math inline">\(3.88*10^{-103}\)</span>. And we take <span class="math inline">\(\alpha = 0.05\)</span>, so we can judge that <span class="math inline">\(X_1\)</span> and <span class="math inline">\(Y_1\)</span> are not independent.</p>
<p>Secondly,we choose <span class="math display">\[X_2 \sim N(0,1) \\ Y_2 \sim \chi^2(2)\]</span> Obviously, <span class="math inline">\(X_2\)</span> and <span class="math inline">\(Y_2\)</span> are independent of each other. Then, test it.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">15</span>,<span class="dv">0</span>,<span class="dv">1</span>)    </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>Y2 <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">15</span>,<span class="dv">2</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>Z2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X2,Y2)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>a2 <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> Z2, <span class="at">statistic =</span>xyCor, <span class="at">R=</span><span class="dv">999</span>, <span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="fu">c</span>(a2<span class="sc">$</span>t0,a2<span class="sc">$</span>t)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(b2 <span class="sc">&gt;=</span> a2<span class="sc">$</span>t0)</span></code></pre></div>
<pre><code>## [1] 0.445</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X2,Y2)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>c2<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.860416</code></pre>
<p>The achieved significance level of the permutation test is close to <span class="math inline">\(0.445\)</span>. The p-value reported by cor.test on the same samples is <span class="math inline">\(0.860\)</span>. And we take <span class="math inline">\(\alpha = 0.05\)</span>, so we can judge that <span class="math inline">\(X_2\)</span> and <span class="math inline">\(Y_2\)</span> are independent.</p>
<p><strong>2.</strong> We take <span class="math inline">\(\alpha = 0.1\)</span>.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.1</span>;</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span>; k<span class="ot">&lt;-</span><span class="dv">3</span>; p<span class="ot">&lt;-</span><span class="dv">2</span>;B<span class="ot">&lt;-</span><span class="dv">99</span>; </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>L1 <span class="ot">&lt;-</span> L2 <span class="ot">&lt;-</span> <span class="dv">15</span>; L <span class="ot">&lt;-</span> L1<span class="sc">+</span>L2; LL <span class="ot">=</span> <span class="fu">c</span>(L1,L2)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>NN <span class="ot">&lt;-</span> <span class="cf">function</span>(X, ix, sizes,k) {</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  L1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]; L2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]; L <span class="ot">&lt;-</span> L1 <span class="sc">+</span> L2</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(X)) X <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X,<span class="dv">0</span>);</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> X[ix, ];</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>X, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>) </span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  part1 <span class="ot">&lt;-</span> Y<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>L1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  part2 <span class="ot">&lt;-</span> Y<span class="sc">$</span>nn.idx[(L1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>L,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="fu">sum</span>(part1 <span class="sc">&lt;=</span> L1); j <span class="ot">&lt;-</span> <span class="fu">sum</span>(part2 <span class="sc">&gt;</span> L1)</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  (i <span class="sc">+</span> j) <span class="sc">/</span> (k <span class="sc">*</span> L)</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>NNtest <span class="ot">&lt;-</span> <span class="cf">function</span>(X,sizes,k){</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>X,<span class="at">statistic=</span>NN,<span class="at">R=</span>B,<span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> sizes,<span class="at">k=</span>k)</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  T <span class="ot">&lt;-</span> <span class="fu">c</span>(b<span class="sc">$</span>t0,b<span class="sc">$</span>t)</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>  pv <span class="ot">&lt;-</span> <span class="fu">mean</span>(T<span class="sc">&gt;=</span>T[<span class="dv">1</span>])</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic=</span>T[<span class="dv">1</span>],<span class="at">p.value=</span>pv)</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,N,<span class="dv">3</span>)</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(L1<span class="sc">*</span>p),<span class="at">ncol=</span>p);</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>  B1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(L2,<span class="dv">0</span>,<span class="dv">2</span>),<span class="fu">rnorm</span>(L2,<span class="dv">0</span>,<span class="dv">2</span>));</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>  C1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(A1,B1)</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>  p1[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">NNtest</span>(C1,LL,k)<span class="sc">$</span>p.value</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>  p1[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(C1,<span class="at">sizes=</span>LL,<span class="at">R=</span>B)<span class="sc">$</span>p.value</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>  p1[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>A1,<span class="at">y=</span>B1,<span class="at">num.permutations =</span> B,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>powercomparison1 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p1<span class="sc">&lt;</span>alpha)</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,N,<span class="dv">3</span>)</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>  A2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(L1,<span class="dv">0</span>,<span class="dv">2</span>),<span class="fu">rnorm</span>(L1,<span class="dv">0</span>,<span class="dv">2</span>));</span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>  B2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(L2,<span class="fl">1.5</span>,<span class="dv">3</span>),<span class="fu">rnorm</span>(L2,<span class="fl">1.5</span>,<span class="dv">3</span>));</span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>  C2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(A2,B2)</span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>  p2[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">NNtest</span>(C2,LL,k)<span class="sc">$</span>p.value</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>  p2[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(C2,<span class="at">sizes=</span>LL,<span class="at">R=</span>B)<span class="sc">$</span>p.value</span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>  p2[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>A2,<span class="at">y=</span>B2,<span class="at">num.permutations =</span> B,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>powercomparison2 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p2<span class="sc">&lt;</span>alpha)</span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,N,<span class="dv">3</span>)</span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a>  A3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rt</span>(L1<span class="sc">*</span>p,<span class="dv">1</span>),<span class="at">ncol=</span>p);</span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a>  B3 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(L2),<span class="fu">rnorm</span>(L2,<span class="dv">1</span>,<span class="fl">1.5</span>));</span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>  C3 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(A3,B3)</span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a>  p3[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">NNtest</span>(C3,LL,k)<span class="sc">$</span>p.value</span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a>  p3[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(C3,<span class="at">sizes=</span>LL,<span class="at">R=</span>B)<span class="sc">$</span>p.value</span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a>  p3[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>A3,<span class="at">y=</span>B3,<span class="at">num.permutations =</span> B,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a>powercomparison3 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p3<span class="sc">&lt;</span>alpha)</span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,N,<span class="dv">3</span>)</span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a>L1<span class="ot">&lt;-</span><span class="dv">10</span>;L2<span class="ot">&lt;-</span><span class="dv">100</span>;L<span class="ot">&lt;-</span>L1<span class="sc">+</span>L2;LL<span class="ot">=</span><span class="fu">c</span>(L1,L2)</span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a>  A4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(L1<span class="sc">*</span>p),<span class="at">ncol=</span>p);</span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a>  B4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(L2<span class="sc">*</span>p,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">ncol=</span>p);</span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a>  C4 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(A4,B4)</span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a>  p4[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">NNtest</span>(C4,LL,k)<span class="sc">$</span>p.value</span>
<span id="cb47-69"><a href="#cb47-69" aria-hidden="true" tabindex="-1"></a>  p4[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(C4,<span class="at">sizes=</span>LL,<span class="at">R=</span>B)<span class="sc">$</span>p.value</span>
<span id="cb47-70"><a href="#cb47-70" aria-hidden="true" tabindex="-1"></a>  p4[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x=</span>A4,<span class="at">y=</span>B4,<span class="at">num.permutations =</span> B,<span class="at">seed=</span>i<span class="sc">*</span><span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb47-71"><a href="#cb47-71" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-72"><a href="#cb47-72" aria-hidden="true" tabindex="-1"></a>powercomparison4 <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(p4<span class="sc">&lt;</span>alpha)</span>
<span id="cb47-73"><a href="#cb47-73" aria-hidden="true" tabindex="-1"></a>powercomparison <span class="ot">&lt;-</span> <span class="fu">rbind</span>(powercomparison1,powercomparison2,powercomparison3,powercomparison4)</span>
<span id="cb47-74"><a href="#cb47-74" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(powercomparison) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;NN&#39;</span>,<span class="st">&#39;Energy&#39;</span>,<span class="st">&#39;Ball&#39;</span>)</span>
<span id="cb47-75"><a href="#cb47-75" aria-hidden="true" tabindex="-1"></a>powercomparison</span></code></pre></div>
<pre><code>##                    NN Energy Ball
## powercomparison1 0.53   0.44 0.90
## powercomparison2 0.43   0.71 0.78
## powercomparison3 0.32   0.62 0.66
## powercomparison4 0.37   0.90 1.00</code></pre>
<p>As you can see, different methods have different power in different situations. Ball method performs well in the above situation.</p>
</div>
<div id="homework7" class="section level2">
<h2>Homework7</h2>
<p>Exercise 9.3 and 9.8 (pages 277-278, Statistical Computating with R).</p>
<p>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R &lt; 1.2\)</span>.</p>
<p><strong>9.3</strong></p>
<p><span class="math inline">\(-\infty &lt;x&lt; \infty\)</span> in the Cauthy distribution, so we choose the proposal distribution is normal <span class="math display">\[g( \cdot |X_t) \sim N(X_t,\sigma^2) , -\infty &lt;x&lt; \infty\]</span></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(theta,eta,x){   </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(theta <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="dv">1</span><span class="sc">/</span>(theta<span class="sc">*</span>pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>((x<span class="sc">-</span>eta)<span class="sc">/</span>theta)<span class="sc">^</span><span class="dv">2</span>)) )</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">2000</span>;</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n);</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">runif</span>(n);</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>A[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>);   </span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>i <span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>theta<span class="ot">=</span><span class="dv">1</span>;eta<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){       </span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  At <span class="ot">&lt;-</span> A[j<span class="dv">-1</span>]</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,At,<span class="dv">1</span>)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  H1 <span class="ot">&lt;-</span> <span class="fu">f</span>(theta,eta,B)<span class="sc">*</span><span class="fu">dnorm</span>(At,B,<span class="dv">1</span>)</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  H2 <span class="ot">&lt;-</span> <span class="fu">f</span>(theta,eta,At)<span class="sc">*</span><span class="fu">dnorm</span>(B,At,<span class="dv">1</span>)</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(C[j]<span class="sc">&lt;=</span>H1<span class="sc">/</span>H2)</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>    A[j] <span class="ot">=</span> B</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>    A[j] <span class="ot">=</span> At</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">=</span> i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>burnin <span class="ot">&lt;-</span> <span class="dv">1001</span> </span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> A[burnin<span class="sc">:</span>n]</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(X,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>))  </span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>q2 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>),<span class="at">df=</span><span class="dv">1</span>)   </span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">rbind</span>(q1,q2)</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(Q))</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="3%" />
<col width="10%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">10%</th>
<th align="right">20%</th>
<th align="right">30%</th>
<th align="right">40%</th>
<th align="right">50%</th>
<th align="right">60%</th>
<th align="right">70%</th>
<th align="right">80%</th>
<th align="right">90%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">q1</td>
<td align="right">-1.610004</td>
<td align="right">-0.9447575</td>
<td align="right">-0.5407671</td>
<td align="right">-0.2531220</td>
<td align="right">-0.0236688</td>
<td align="right">0.2240183</td>
<td align="right">0.4875767</td>
<td align="right">0.7889158</td>
<td align="right">1.301216</td>
</tr>
<tr class="even">
<td align="left">q2</td>
<td align="right">-3.077684</td>
<td align="right">-1.3763819</td>
<td align="right">-0.7265425</td>
<td align="right">-0.3249197</td>
<td align="right">0.0000000</td>
<td align="right">0.3249197</td>
<td align="right">0.7265425</td>
<td align="right">1.3763819</td>
<td align="right">3.077684</td>
</tr>
</tbody>
</table>
<p>As we can see, the deciles of the generated observations and the deciles of the standard Cauchy distribution are very close.</p>
<p><strong>9.8</strong></p>
<p>We choose <span class="math inline">\(a=1\)</span>, <span class="math inline">\(b=1\)</span>, <span class="math inline">\(n=10\)</span>, then use the Gibbs sampler to generate a chain with target joint density <span class="math inline">\(f(x,y)\)</span>.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fl">1e3</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>bi <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,M,<span class="dv">2</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span> ; b <span class="ot">&lt;-</span> <span class="dv">1</span> ; n <span class="ot">&lt;-</span> <span class="dv">10</span> </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>A[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)   </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>M){    </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> A[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  A[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">10</span>,y)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> A[i,<span class="dv">1</span>]</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  A[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> A[(bi<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>M,]    </span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(X)  </span></code></pre></div>
<pre><code>## [1] 5.2080000 0.5256165</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(X)</span></code></pre></div>
<pre><code>##            [,1]       [,2]
## [1,] 10.8255616 0.89847313
## [2,]  0.8984731 0.08827151</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(X)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 1.0000000 0.9191144
## [2,] 0.9191144 1.0000000</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X,<span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAYFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6ZrY6kNtmAABmZjpmZrZmkJBmtv+QOgCQZgCQ2/+2ZgC2Zjq2Zma2/7a2///bkDrb/7bb////tmb/25D//7b//9v///8QJrI/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJHUlEQVR4nO2dbXejNhCFSZu47brtuuu26y62+f//srzaIDG6IzRgOb7PB84hgCyejEYSKHFRkSDFoyuQOxQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCGAsqHgaHiXItrgV6N1Q0IATLEP0UFCPI+PWvjYWFN+0N6JoI+heq0cJWqu4ZNxfGwU5UJCXhaf7FORm4UoQ4u6/jCAxC8/uvqIgz8CwEQ6/nqBqLMSNKAryBL1ABEUNN18wB0XNlGQD4PBKgo5F8XE91J/w1aQ4uYRAOdMAy0vQ6f1H7eijqi77LwbFBUqQy5Fmn/P72wq6Hmot5du3qlOVWlyoQmI57uGsctBlX7es8qfv1bBNKy5Qo1AABYW8QASBXszv1jMSdM9Brark4qQqPa+gLXoxv4lNhHlNLKcctElxXpKeCss6B21SnN9NOfuTG85W0MmwF5vmHCAICMlGkFvKjQXXOrVwR4KjbfWKTcwfGDqaoyKGgjIX1HbxNUIGMhEEmljWgk5FPz4sC7uBYliI+hHh/P62gkbjZ8upxrRJzXbrijuOPH0VQe1ktcNysrqloFtGe6IIQt38Ewmqc1AfQoY5CPVi2qfw8/ve4WG7Ui922XcfKMSPjSDnuG0OGrbPPA5yjr+6IPB4wzwHzX0iqp4h6b3Yykl6+LQnEoQGiomChs3Sij5ckNUjQt3pTxhBqVl3mxw0dN894lxUWVzUFZsKWtqLjSYRlTyPUBcXdYWTJSjIu6LYMAc94Tho7Qialr58HHQq+pdd0uP4uOIirjDOQeHHR4t7sdPbt7qdfVQLBRU3Fl7rFSXtY5/VOGTcBns/T129dts9yLge6kno1hFkLMgrTqjUwiR9fP+xeRNzrjMW5E5kois6jqCa48eTC/I7RZMIujWsesS4uSDnjoxzkFCrBb1Y18iuh81z0PQy2wiyE2SEqjgniz5HBBmhKW4aMviOs8hBd+oRY7vIbhmKz13pTeBtvxpHkFUvZoZGkHvH1eSOjCMooaKRJ44476QVeDpBVTXJEqY5SDvRWjhQ7JBm8+OnRsvfrLqCbJuY2KbiKzo+Ufm4o39fmBhBq+YgLdGCijHiUOiyb14ZpjaxuKSCTq/G8ahmtRx0rLu4WEHObzicVa2bmBBeCYL+CY+kT8WXSEFeFnWaWDUJgVRB7sBcqpR0B/MnXv4Y9s87NNU4736OEhR7x+GIgi1yWg2r50GXfT84PCrmqteDuNB+XlAVCpHkHBQW5LVAuaLBO6pv+qMJjmabwmxV0kLCOX1mKlHJ+2IOj89BZfH2u36SEbGQfO0ImpbuzfQqK0F9EC2juNHv+cek/VRBXpIpprpsclDV9E51BCU9CxqKc/uRtJAAp4OphVkE1SPF9k9RpaV1EcWZP+AJCwJTC/fsUUV1xPVimoXkfgi4+0mCRlsVgr91xkGqheR+vxKMKCgoPK5EESSxIEkPyCNp3TJg8wiaXB6Zg0QSBMnoFpKvm4P8iUvsXYyvszyxUi8kT+3Fwk0MDBS1rCJIu5Dc6WWMR9LTWuclaNFCctsm5gnJKQdpi3MiyDgHuZWeflpURU1P1BfnplFbQQuFzFXU9kR1caBbTxZkVlHjE9XFrdzN21XU+ER1cbFZl4IoaFpctKBhozrdsKLGJ6qLYwSB4qwFSc8EkytqfKK6uERB3iOuhUNlXFHjE9XFpQryRoIrNLDNBRU3KAgWFy1o2IxqxCYWSNJOtdx9u4oan6guLllQYfJEDFfU+ER1camC3IHjGtX8TIKYg7wmNd1nLwaS9Eo8r6CVmtRMRY1PVBeXKmidJjVTUeMT1cUlC9qElQTpFi+8riDd4oXXFaRdvBAnaJ3nPYhVBCkXL8RG0LDZlJwjaBoynymCdIsXkCB3oLPNuMdlpV5Ms3gBCnIHOg9I0VmPg/IgI0HeU/gsWFtQYKU9bFJZsHEEFTdybVIuD2xieTYpl0cKyrJJuTxwsvocPGyy+jSsIUgx1dAVCo6nHU69POF0xWRVV+hnFcQIQuDJqq7QTysIT1Z1hX5eQUaFUlDacQqioLTjn1/QZ4KCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUB7AWV4f/Y3b5aC/8jsGPggeV5VwT/F93tG2ZmL/71u6KGU8wFlfVnl/LnXw/1sVPwHsvAE92yPtR9g8w8zTfMlJKhy759FwNq6GAtqHvzcRRvofs/sKEv77jsZUFd6fLV18OH/Oll90YY1dDBWhAW0BD6BZ7e/xIFnX8J/+JDgsriS/s2T1fDG+aC2ltA31B2lI/XBcg5qPzp330wgwWbWFctXQ1vWAvqYgM08cBrtaYByIJOTSPpwkQsOpCAWyuqGt55hKAykKObV7YBQW/gt9+E5nkn6c9BkCKAQ69l28sDgtpy5X/4DfJLDk0Mp8BTMIf0i1MEA91tyakaREcOSRp2oid5HDcgR1C3vkT+7Xc3L3+rQwbdPBqGyQniTmAk3aSo0SIT/1Kcgx48UERfDtS3oWD9QlONEkxUjqHjfWhFfX0RJ6sACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQECBHQedd93L+VHw97+4rOptFvNdDxGt1E3IU1C+xalZpjNZKjRbxbkmWgtpVLO1SxLugfhEvBbU0a8VP9+Vg1X0RLwV1nHd/tmrGyxEpaEy/kpGCBOreylvQSkEjju//tX+yQkHzNH9N0Pb1FDTLedf+TUqtgoLmuB5aFZf9+w8KmqFO0J2VsvhoBA1/vEJBM7QRdP5t9BMKmtAKKscrwyloQjub//uuhLP57KAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgP8B19TLLtu+jWgAAAAASUVORK5CYII=" /><!-- --> From the final analysis of the chain, we can get some data properties.</p>
<p><strong>2.</strong></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>GR <span class="ot">&lt;-</span> <span class="cf">function</span>(fai){</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  fai <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(fai)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(fai)  </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(fai)  </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  faibar <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(fai)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  Bn <span class="ot">&lt;-</span> n<span class="sc">*</span><span class="fu">var</span>(faibar)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  Wn <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">apply</span>(fai, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>))</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((Wn<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">+</span>(Bn<span class="sc">/</span>n))<span class="sc">/</span>Wn)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Firstly, we use the Gelman-Rubin method to monitor convergence of the chain in <span class="math inline">\(9.3\)</span>.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">2000</span>;</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">4</span>;</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>chain93 <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n);</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  C <span class="ot">&lt;-</span> <span class="fu">runif</span>(n);</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  A[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">20</span>; </span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  theta<span class="ot">=</span><span class="dv">1</span>;eta<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){         </span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>    At <span class="ot">&lt;-</span> A[j<span class="dv">-1</span>]</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>    B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,At,<span class="dv">1</span>)</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>    H1 <span class="ot">&lt;-</span> <span class="fu">f</span>(theta,eta,B)<span class="sc">*</span><span class="fu">dnorm</span>(At,B,<span class="dv">1</span>)</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>    H2 <span class="ot">&lt;-</span> <span class="fu">f</span>(theta,eta,At)<span class="sc">*</span><span class="fu">dnorm</span>(B,At,<span class="dv">1</span>)</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(C[j]<span class="sc">&lt;=</span>H1<span class="sc">/</span>H2)</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>      A[j] <span class="ot">=</span> B</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>      A[j] <span class="ot">=</span> At</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>      i <span class="ot">=</span> i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(A)</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,m,n)</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>  Z[i,] <span class="ot">&lt;-</span> <span class="fu">chain93</span>()</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>fai <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(Z,<span class="dv">1</span>,cumsum))</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(fai))</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>  fai[i,] <span class="ot">&lt;-</span> fai[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(fai))</span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">GR</span>(fai))</span></code></pre></div>
<pre><code>## [1] 1.444076</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span>;</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">GR</span>(fai[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>n)], <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> As we can see, we haven’t get <span class="math inline">\(\hat R&lt;1.2\)</span>, so the chain in <span class="math inline">\(9.3\)</span> does not converge.</p>
<p>Secondly, we use the Gelman-Rubin method to monitor convergence of the chain in <span class="math inline">\(9.8\)</span>.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">2000</span>;</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">4</span>;</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>chain98 <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,M,<span class="dv">2</span>)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="dv">1</span> ; b <span class="ot">&lt;-</span> <span class="dv">1</span> ; n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  A[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)  </span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>M){    </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> A[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    A[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">10</span>,y)</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> A[i,<span class="dv">1</span>]</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>    A[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(A)</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>Z1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,m,M)</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>Z2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,m,M)</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  Q <span class="ot">&lt;-</span> <span class="fu">chain98</span>()</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> Q[,<span class="dv">1</span>]</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> Q[,<span class="dv">2</span>]</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>  Z1[i,] <span class="ot">&lt;-</span> c</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>  Z2[i,] <span class="ot">&lt;-</span> d</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>fai1 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(Z1,<span class="dv">1</span>,cumsum))</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(fai1))</span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>  fai1[i,] <span class="ot">&lt;-</span> fai1[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(fai1))</span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">GR</span>(fai1))</span></code></pre></div>
<pre><code>## [1] 1.729638</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>fai2 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(Z2,<span class="dv">1</span>,cumsum))</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(fai2))</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  fai2[i,] <span class="ot">&lt;-</span> fai2[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(fai2))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">GR</span>(fai2))</span></code></pre></div>
<pre><code>## [1] 1.792563</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span>;</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>Xrhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,M)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>M)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  Xrhat[j] <span class="ot">&lt;-</span> <span class="fu">GR</span>(fai1[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Xrhat[(b<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>M)],<span class="at">xlab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>Yrhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,M)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>M)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  Yrhat[j] <span class="ot">&lt;-</span> <span class="fu">GR</span>(fai2[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Yrhat[(b<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>M)], <span class="at">xlab=</span><span class="st">&quot;Y&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R_hat&quot;</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> As we can see, we haven’t get <span class="math inline">\(\hat R&lt;1.2\)</span>, so the chain in <span class="math inline">\(9.8\)</span> does not converge, too.</p>
</div>
<div id="homework8" class="section level2">
<h2>Homework8</h2>
<p>Exercises 11.3 and 11.5 (pages 353-354, Statistical Computing with R)</p>
<p>Suppose <span class="math inline">\(T_1,...,T_n\)</span> are <span class="math inline">\(i.i.d.\)</span> samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i = T_iI(T_i \le \tau)+\tau I(T_i &gt; \tau)\)</span>,<span class="math inline">\(i = 1,...,n\)</span>. Suppose <span class="math inline">\(\tau = 1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: <span class="math display">\[0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85\]</span> Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data MLE (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution)</p>
<p><strong>11.3</strong></p>
<p><strong>(a)</strong> As required, we need to compute <span class="math display">\[Y_k = \frac{(-1)^k}{k!2^k}\frac{{||a||^{2k+2}}}{(2k+1)(2k+2)}\frac{\Gamma(\frac{d+1}{2})\Gamma(k+\frac{3}{2})}{\Gamma(k+\frac{d}{2}+1)}\]</span></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>Yk <span class="ot">&lt;-</span> <span class="cf">function</span>(k,a){</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  yk1 <span class="ot">=</span> (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">/</span><span class="fu">factorial</span>(k)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">^</span>k)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">=</span> <span class="fu">length</span>(a)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  ena <span class="ot">=</span> <span class="dv">0</span>           </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d){</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    ena <span class="ot">&lt;-</span> ena <span class="sc">+</span> a[i]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  ena <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(ena)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  yk2 <span class="ot">=</span> (ena<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>))<span class="sc">/</span>((<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>))</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  yk3 <span class="ot">=</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="fl">+1.5</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(yk1 <span class="sc">*</span> yk2 <span class="sc">*</span> yk3)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>(b)</strong> Then, we need to compute <span class="math display">\[\sum_{k=0}^{\infty}Y_k\]</span></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>SumofYk <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">0</span>; sumofyk<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">abs</span>(<span class="fu">Yk</span>(i,a)) <span class="sc">&gt;</span> <span class="fl">0.00000001</span>) {    </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>      sumofyk<span class="ot">=</span>sumofyk <span class="sc">+</span> <span class="fu">Yk</span>(i, a);</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>      i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span>;</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sumofyk)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>(c)</strong></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">SumofYk</span>(a)</span></code></pre></div>
<pre><code>## [1] 1.532164</code></pre>
<p>As we can see, the sum of <span class="math inline">\(a = {(1,2)}^T\)</span> is <span class="math inline">\(1.532164\)</span>.</p>
<p><strong>11.5</strong></p>
<p>If we make <span class="math inline">\(X_{k-1}\)</span> equal to the left side of the equation, we need to solve the equation <span class="math display">\[X_{k-1} = X_k\]</span> As we all know, the probability density function of <span class="math inline">\(t(n)\)</span> is <span class="math display">\[f(x)=\frac{\Gamma(\frac{n+1}{2})}{\sqrt{n\pi}\Gamma(\frac{n}{2})}(1+\frac{x^2}{n})^{-\frac{n+1}{2}}\]</span> And the probability density function of <span class="math inline">\(t(n)\)</span> is symmetric about the y-axis. So, <span class="math display">\[X_{k-1} = X_k\]</span> is equivalent to <span class="math display">\[S_{k-1} = S_k\]</span> Where <span class="math inline">\(S_k\)</span> has been defined in <span class="math inline">\(11.4\)</span>.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>aoff <span class="ot">&lt;-</span> <span class="cf">function</span>(k){</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">uniroot</span>( <span class="cf">function</span>(a) {<span class="fu">pt</span>(<span class="fu">sqrt</span>((a<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),<span class="at">df=</span>k<span class="dv">-1</span>)<span class="sc">-</span><span class="fu">pt</span>(<span class="fu">sqrt</span>((a<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),<span class="at">df=</span>k)}</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>                ,<span class="fu">c</span>(<span class="fl">0.00002</span>, <span class="fu">sqrt</span>(k)<span class="sc">-</span><span class="fl">0.00002</span>))<span class="sc">$</span>root</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">length</span>(N)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">numeric</span>(L)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>L){</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  X[j]<span class="ot">=</span><span class="fu">aoff</span>(N[j])</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">cbind</span>(N,X)</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Y) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;k&quot;</span>,<span class="st">&quot;a&quot;</span>)</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>Y</span></code></pre></div>
<pre><code>##          k         a
##  [1,]    4  1.492103
##  [2,]    5  1.533549
##  [3,]    6  1.562768
##  [4,]    7  1.584421
##  [5,]    8  1.601182
##  [6,]    9  1.614541
##  [7,]   10  1.625383
##  [8,]   11  1.634409
##  [9,]   12  1.642033
## [10,]   13  1.648539
## [11,]   14  1.654192
## [12,]   15  1.659098
## [13,]   16  1.663452
## [14,]   17  1.667288
## [15,]   18  1.670736
## [16,]   19  1.673841
## [17,]   20  1.676588
## [18,]   21  1.679139
## [19,]   22  1.681461
## [20,]   23  4.795812
## [21,]   24  4.898959
## [22,]   25  4.999980
## [23,]  100  9.999980
## [24,]  500 22.360660
## [25,] 1000 31.622757</code></pre>
<p>As we can see, the solution of <span class="math inline">\(11.5\)</span> is equal to the solution of <span class="math inline">\(11.4\)</span>. Because the two equations are also equivalent.</p>
<p><strong>2.</strong></p>
<p>The probability density function of <span class="math inline">\(Exp(\lambda)\)</span> is <span class="math display">\[f(y)=\lambda e^{-\lambda y},    y&gt;0\]</span> And we can get <span class="math display">\[\int_{1}^{\infty}\lambda e^{-\lambda y}\,dy=e^{-\lambda}\]</span> As we can see, <span class="math inline">\(7\)</span> of the observed <span class="math inline">\(Y_i\)</span> values less than <span class="math inline">\(1\)</span>. We call it <span class="math inline">\(y_i,i=1,..,7\)</span>.</p>
<p>Firstly, we consider the <span class="math inline">\(MLE\)</span> of the observed data. <span class="math display">\[L(Y;\lambda)=C_{10}^3*(e^{-\lambda})^3 \prod_{i=1}^{7}(\lambda e^{-\lambda y_i})\]</span> <span class="math display">\[logL(Y;\lambda)=log(C_{10}^3)-3\lambda+7log\lambda-\lambda\sum_{i=1}^{7}y_i\]</span> After the derivation, we can get <span class="math display">\[\hat \lambda=\frac{7}{\sum_{i=1}^{7}y_i+3}=\frac{28}{27} \approx 1.037037\]</span></p>
<p>Secondly, use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>.</p>
<p>(1)Initiate <span class="math inline">\(\lambda\)</span> with <span class="math inline">\(\lambda _0\)</span>.</p>
<p>(2)Complete data likelihood: <span class="math display">\[L(\lambda;Y)=\prod_{i=1}^{10}(\lambda e^{-\lambda y_i})\]</span> <span class="math display">\[logL(\lambda;Y)=10log\lambda-\lambda\sum_{i=1}^{10}y_i\]</span></p>
<p>(3)E-step: <span class="math display">\[I_0=E_{\lambda _0}[logL|Y]=10log\lambda-\lambda\sum_{i=1}^{k}y_i-\lambda\sum_{i=k+1}^{10}(\int_1^{\infty}y_ie^{-\lambda_0(x-1)}\,dy_i) \]</span> <span class="math display">\[I_0=10log\lambda-\lambda\sum_{i=1}^{k}y_i-\lambda(10-k)(\frac{1}{\lambda_o}+1)\]</span></p>
<p>(4)M-step: <span class="math display">\[maxI_0\]</span> We can get <span class="math display">\[\lambda_1=\frac{10}{\sum_{i=1}^{k}y_i+(10-k)(\frac{1}{\lambda_o}+1)}\]</span></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">/</span>(<span class="fu">sum</span>(x)<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span>A)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="fu">abs</span>(B<span class="sc">-</span>A)<span class="sc">&gt;</span><span class="fl">0.000000000001</span>){</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> B</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">/</span>(<span class="fu">sum</span>(x)<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span>A)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>B</span></code></pre></div>
<pre><code>## [1] 1.037037</code></pre>
<p>As we can see, the results of E-M and the observed data MLE are the same.</p>
</div>
<div id="homework9" class="section level2">
<h2>Homework9</h2>
<p>Exercises 1 and 5 (page 204, Advanced R).Excecises 1 and 7 (page 214, Advanced R)</p>
<p><strong>P204 1</strong></p>
<p><span class="math inline">\(trims &lt;- c(0, 0.1, 0.2, 0.5)\)</span></p>
<p><span class="math inline">\(x &lt;- rcauchy(100)\)</span></p>
<p><span class="math inline">\(lapply(trims, function(trim) mean(x, trim = trim))\)</span></p>
<p><span class="math inline">\(lapply(trims, mean, x = x)\)</span></p>
<p>Because both of the two invocations of lapply() mean: after arranging vector <span class="math inline">\(x\)</span> in order, cut off <span class="math inline">\(0\%,10\%,20\%,50\%\)</span> of the Outliers at the beginning and end, and find the mean value of the remaining numbers.</p>
<p>And the first parameter of the <span class="math inline">\(mean()\)</span> can be provided by the third parameter of <span class="math inline">\(lapply()\)</span>, so the following two invocations of lapply() are equivalent.</p>
<p><strong>P204 5</strong></p>
<p>As for Exercise 3:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(mtcars)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp,</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(formulas)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>,n1) </span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)){</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  A1[[j]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[j]])</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>A2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, lm)</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(A1, rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(A2, rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<p>As for Exercise 4:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(bootstraps)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>B1 <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="fu">length</span>(bootstraps)) </span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="fu">seq_along</span>(bootstraps)){</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  B1[[j]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, bootstraps[[j]])</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>B2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, lm, <span class="at">formula =</span> mpg <span class="sc">~</span> disp)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(B1, rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.6157021
## 
## [[2]]
## [1] 0.7426137
## 
## [[3]]
## [1] 0.7090495
## 
## [[4]]
## [1] 0.5515627
## 
## [[5]]
## [1] 0.7422951
## 
## [[6]]
## [1] 0.7390564
## 
## [[7]]
## [1] 0.7944183
## 
## [[8]]
## [1] 0.7864715
## 
## [[9]]
## [1] 0.8016978
## 
## [[10]]
## [1] 0.6228064</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(B2, rsq)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.6157021
## 
## [[2]]
## [1] 0.7426137
## 
## [[3]]
## [1] 0.7090495
## 
## [[4]]
## [1] 0.5515627
## 
## [[5]]
## [1] 0.7422951
## 
## [[6]]
## [1] 0.7390564
## 
## [[7]]
## [1] 0.7944183
## 
## [[8]]
## [1] 0.7864715
## 
## [[9]]
## [1] 0.8016978
## 
## [[10]]
## [1] 0.6228064</code></pre>
<p><strong>P214 1</strong></p>
<p><strong>a</strong>To compute the standard deviation of every column in a numeric data frame. Assume <span class="math inline">\(A\)</span> is a numeric data frame. Then, we can use <span class="math display">\[vapply(A,sd,numric(1))\]</span> <strong>b</strong>To compute the standard deviation of every numeric column in a mixed data frame. Assume <span class="math inline">\(B\)</span> is a mixed data frame. Then, we can use <span class="math display">\[vapply(B[vapply(B, is.numeric, logical(1))],sd,numeric(1))\]</span></p>
<p><strong>P214 7</strong></p>
<p>Firstly, What is vapply? <span class="math inline">\(vapply(X,FUN,FUN.VALUE,…,USE.NAMES=TRUE)\)</span> similar to sapply, but has a pre-specified type of return value, so it can be safer (and sometimes faster) to use.</p>
<p>Secondly, what is sapply? <span class="math inline">\(sapply(X,FUN,…,simplify=TRUE,USE.NAMES=TRUE)\)</span> a user-friendly version and wrapper of lapply by default returning a vector, matrix or, if simplify = “array”, an array if appropriate, by applying <span class="math inline">\(simplify2array()\)</span>. <span class="math inline">\(sapply(x, f, simplify = FALSE, USE.NAMES = FALSE)\)</span> is the same as <span class="math inline">\(lapply(x, f)\)</span>.</p>
<p>And <span class="math inline">\(mcsapply()\)</span> is a multicore version of <span class="math inline">\(sapply()\)</span>.I can’t implement a <span class="math inline">\(mcvapply()\)</span>.</p>
</div>
<div id="homework10" class="section level2">
<h2>Homework10</h2>
<p>(1)Write an Rcpp function for Exercise 9.8 (page 278, StatisticalComputing with R).</p>
<p>(2)Compare the corresponding generated random numbers with pure R language using the function “qqplot”.</p>
<p>(3)Compare the computation time of the two functions with the function “microbenchmark”.</p>
<p>(4)Comments your results.</p>
<p><strong>1.</strong> pure R language:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>pureR <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b,n,M){</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,M,<span class="dv">2</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  A[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)   </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>M){     </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> A[j<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    A[j,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">10</span>,y)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> A[j,<span class="dv">1</span>]</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>    A[j,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(A)</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Rcpp function:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;NumericMatrix CppFun(double a, double b, int n, int M) {</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="st">            NumericMatrix A(M,2); </span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="st">            A(0, 0) = A(0, 1) = 0;</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="st">            double x; double y;</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="st">            for(int j = 1; j &lt; M; j++)</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="st">            {</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="st">              y = A(j-1, 1);</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="st">              A(j, 0) = rbinom(1, n, y)[0];</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="st">              x = A(j, 0);</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="st">              A(j, 1) = rbeta(1, x+a, n-x+b)[0];</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a><span class="st">            return A;</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span>)</span></code></pre></div>
<p><strong>2.</strong></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span>; b <span class="ot">&lt;-</span> <span class="dv">1</span>; n <span class="ot">&lt;-</span> <span class="dv">10</span>; M <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">*</span><span class="fl">1e3</span>;     </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>Z1 <span class="ot">&lt;-</span> <span class="fu">pureR</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">5</span><span class="sc">*</span><span class="fl">1e3</span>)       </span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>Z2 <span class="ot">&lt;-</span> <span class="fu">CppFun</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">5</span><span class="sc">*</span><span class="fl">1e3</span>)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))       </span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(Z1[<span class="dv">1001</span><span class="sc">:</span>M,<span class="dv">1</span>],Z2[<span class="dv">1001</span><span class="sc">:</span>M,<span class="dv">1</span>],<span class="at">xlab=</span><span class="st">&#39;pure R language_x&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Rcpp function_x&#39;</span>)</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(Z1[<span class="dv">1001</span><span class="sc">:</span>M,<span class="dv">2</span>],Z2[<span class="dv">1001</span><span class="sc">:</span>M,<span class="dv">2</span>],<span class="at">xlab=</span><span class="st">&#39;pure R language_y&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Rcpp function_y&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>3.</strong></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>timecompare <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">R=</span><span class="fu">pureR</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">5</span><span class="sc">*</span><span class="fl">1e3</span>),<span class="at">Rcpp=</span><span class="fu">CppFun</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">5</span><span class="sc">*</span><span class="fl">1e3</span>))  </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(timecompare)[, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)])</span></code></pre></div>
<pre><code>##   expr        lq    median        uq
## 1    R 19.252001 23.980651 25.743402
## 2 Rcpp  2.007551  2.024101  2.056201</code></pre>
<p><strong>4.</strong> As we can see, the computation time of the Rcpp function is much less than pure R language. So the Rcpp function is more efficient.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
